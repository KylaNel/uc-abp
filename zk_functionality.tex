% \begin{tcolorbox}[enhanced, colback=white, arc=5pt, breakable]
\begin{tcolorbox}[colback=white, arc=5pt]
    \noindent\emph{\underline{Zero-knowledge functionality $\mathcal{F}_{ZK}^{R,R'}$}}\\[5pt]
    \begin{enumerate}
        \item Wait for an input (\textbf{prove, $y$, $w$}) from $P$ such that $(y,w)\in R$ if $P$ is honest, or ${y,w}\in R'$ if $P$ is corrupt. Send (\textbf{prove}, l(y)) to $\mathcal{A}$. Further, wait for a message \textbf{ready} from $V$, and send \textbf{ready} to $\mathcal{A}$.
        \item  Wait for message \textbf{lock} from $\mathcal{A}$.
        \item Upon receiving a message \textbf{done} from $\mathcal{A}$, send \textbf{done} to $P$. Further, wait for an input \textbf{proof} from $\mathcal{A}$ and send (\textbf{proof}, $y$) to $V$.
    \end{enumerate}

    Corruption rules:
    \begin{itemize}
        \item If $P$ gets corrupted after sending (\textbf{prove}, $y$, $w$) and before Step 2, $\mathcal{A}$ is given $(y, w)$ and is allowed to change this value to any value $(y',w')\in R'$ at any time before Step 2. 
    \end{itemize}
    
    \end{tcolorbox}
    \captionof{figure}{Zero-knowledge functionality $\mathcal{F}_{ZK}^{R,R'}$}
    \label{fig:zk_functionality}